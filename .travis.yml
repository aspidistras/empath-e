language: python

python:
  - "3.7.5"

services:
  - postgresql
  - docker

before_script:
  - psql -c "CREATE USER clem WITH PASSWORD 'clem';" -U postgres
  - psql -c "CREATE DATABASE empath_e;" -U postgres
  - psql -c "GRANT ALL ON DATABASE empath_e TO clem;" -U postgres
  - psql -c "ALTER USER clem WITH CREATEDB;" -U postgres

before_install:
  - docker run -p 6379:6379 -d redis:5

install:
  - pip install -r requirements.txt

script:
  - python manage.py collectstatic
  - python manage.py test
